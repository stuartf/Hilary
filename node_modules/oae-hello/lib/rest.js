var HelloAPI = require('oae-hello');
var HelloConstants = require('./constants');
var OAE = require('oae-util');

OAE.tenantServer.get('/api/favorite', function(req, res) {
    req.telemetryUrl = '/api/favorite';

    var ctx = req.ctx;
    HelloAPI.getFavorite(ctx, function(err, color) {
        if (err) {
            return res.send(err.code, err.msg);
        }

        return res.send(200, color);
    });
});

OAE.tenantServer.post('/api/favorite/:color', function(req, res) {
    req.telemetryUrl = '/api/favorite/color';

    var ctx = req.ctx;
    var color = HelloAPI.getColorById(req.params.color);

    if (color === undefined) {
        return res.send(400, 'Invalid color');
    }
    debugger;
    HelloAPI.setFavorite(ctx, color, function(err) {
        if (err) {
            return res.send(err.code, err.msg);
        }

        return res.send(200);
    });
});

OAE.tenantServer.get('/api/favorite/list', function(req, res) {
    req.telemetryUrl = '/api/favorite/list';

    return res.send(200, HelloConstants.colors);
});
