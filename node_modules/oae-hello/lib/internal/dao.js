var Cassandra = require('oae-util/lib/cassandra');

var getFavorite = module.exports.getFavorite = function(userId, callback) {
    Cassandra.runQuery('SELECT colorId, hex FROM FavoriteColors USING CONSISTENCY QUORUM WHERE userId = ?', [userId], function(err, rows) {
        if (err) {
            return callback(err);
        }

        return callback(null, Cassandra.rowToHash(rows[0]));
    });
};

var saveFavorite = module.exports.saveFavorite = function(userId, color, callback) {
    var q = Cassandra.constructUpsertCQL('FavoriteColors', 'userId', userId, color, 'QUORUM');
    return Cassandra.runQuery(q.query, q.parameters, callback);
};
